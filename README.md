# SwiftFFetch

[![66% Vibe_Coded](https://img.shields.io/badge/66%25-Vibe_Coded-ff69b4?style=for-the-badge&logo=zedindustries&logoColor=white)](https://github.com)

SwiftFFetch is a Swift library for fetching and processing content from AEM (.live) Content APIs and similar JSON-based endpoints. It is designed for composable applications, making it easy to retrieve, paginate, and process content in a Swift-native way.

## Features

- **Swift-native API**: Designed for idiomatic use in Swift projects.
- **Async/Await Support**: Uses Swift concurrency for efficient, modern code.
- **Pagination**: Handles paginated endpoints seamlessly.
- **Composable**: Chainable methods for mapping, filtering, and transforming content.
- **Sheet Selection**: Access specific sheets in multi-sheet JSON resources.
- **Extensible**: Easily integrate with your own models and workflows.

## Installation

Add SwiftFFetch to your `Package.swift` dependencies:

```swift
.package(url: "https://github.com/your-org/swffetch.git", from: "1.0.0")
```

Then add `"SwiftFFetch"` to your target dependencies.

## Usage

### Fetch Entries from an Index

```swift
import SwiftFFetch

let entries = FFetch(url: "https://example.com/query-index.json")
for try await entry in entries {
    print(entry["title"] as? String ?? "")
}
```

### Get the First Entry

```swift
let firstEntry = try await FFetch(url: "https://example.com/query-index.json").first()
print(firstEntry?["title"] as? String ?? "")
```

### Get All Entries as an Array

```swift
let allEntries = try await FFetch(url: "https://example.com/query-index.json").all()
allEntries.forEach { entry in
    print(entry)
}
```

### Map and Filter Entries

```swift
let filteredTitles = FFetch(url: "https://example.com/query-index.json")
    .map { $0["title"] as? String }
    .filter { $0?.contains("Swift") == true }

for try await title in filteredTitles {
    print(title ?? "")
}
```

### Control Pagination with `chunks` and `limit`

```swift
let limitedEntries = FFetch(url: "https://example.com/query-index.json")
    .chunks(100)
    .limit(5)

for try await entry in limitedEntries {
    print(entry)
}
```

### Access a Specific Sheet

```swift
let productEntries = FFetch(url: "https://example.com/query-index.json")
    .sheet("products")

for try await entry in productEntries {
    print(entry["sku"] as? String ?? "")
}
```

## About Query Index Files

The `query-index.json` files used in the examples above are typically generated by AEM Live sites as part of their content indexing process. For more information about how these index files are created and structured, see the [AEM Live Indexing Documentation](https://www.aem.live/developer/indexing).

## Example

See `Examples.swift` in the repository for more detailed usage.

## License

This project is licensed under the terms of the Apache License 2.0. See [LICENSE](LICENSE) for details.

## Development Setup

### Pre-commit Hook
This project uses SwiftLint as a pre-commit hook to ensure code quality. The hook automatically runs before each commit and will prevent commits if there are any linting violations.

To bypass the pre-commit hook (not recommended), use:
```bash
git commit --no-verify
```


To set up the pre-commit hook automatically, run:
```bash
./scripts/setup-pre-commit-hook.sh
```

This script will:
- Check if SwiftLint is installed (and install it via Homebrew if needed)
- Install the pre-commit hook
- Test the hook to ensure it works correctly